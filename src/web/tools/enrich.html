<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POI Enrichment - GPX Tools</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="container">
    <header>
      <nav class="breadcrumb">
        <a href="../">Home</a> / <a href="./">Tools</a> / <span>POI Enrichment</span>
      </nav>
      <h1>POI Enrichment</h1>
      <p class="subtitle">Find Points of Interest along your route from OpenStreetMap</p>
    </header>

    <section class="panel active">
      <div class="upload-area" id="gpx-upload-area">
        <div class="upload-content">
          <span class="upload-icon">ğŸ“‚</span>
          <p>Drag & drop a GPX file here</p>
          <p class="upload-hint">or click to select</p>
          <input type="file" id="gpx-file-input" accept=".gpx" hidden>
        </div>
        <div class="file-info" id="gpx-file-info" hidden>
          <span class="file-name"></span>
          <span class="file-size"></span>
          <button class="clear-btn" title="Clear">âœ•</button>
        </div>
      </div>

      <div class="options">
        <h3>POI Types to Find</h3>
        <div class="checkbox-grid">
          <label class="checkbox-label">
            <input type="checkbox" id="poi-water" checked>
            <span class="checkbox-icon">ğŸ’§</span> Water Sources
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="poi-camping" checked>
            <span class="checkbox-icon">â›º</span> Camping & Shelters
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="poi-resupply" checked>
            <span class="checkbox-icon">ğŸ›’</span> Resupply (Shops & Food)
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="poi-transport">
            <span class="checkbox-icon">ğŸšŒ</span> Transport
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="poi-emergency">
            <span class="checkbox-icon">ğŸ¥</span> Emergency Services
          </label>
        </div>

        <h3>Options</h3>
        <div class="option-row">
          <label for="buffer-km">Search buffer (km from route):</label>
          <input type="number" id="buffer-km" value="5" min="1" max="50" step="1">
        </div>
        <div class="option-row">
          <label for="max-distance">Max distance from route (km):</label>
          <input type="number" id="max-distance" value="2" min="0.1" max="10" step="0.1">
        </div>
      </div>

      <button class="process-btn" id="enrich-btn" disabled>Find POIs</button>

      <div class="progress-area" id="progress-area" hidden>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <p class="progress-text" id="progress-text">Processing...</p>
      </div>

      <div class="results" id="results" hidden>
        <h3>Results</h3>
        <div class="stats" id="stats"></div>

        <div class="map-section">
          <h4>Route & POIs</h4>
          <div id="poi-map" class="map-container"></div>
          <div class="map-legend">
            <span class="legend-item water">ğŸ’§ Water</span>
            <span class="legend-item camping">â›º Camping</span>
            <span class="legend-item resupply">ğŸ›’ Resupply</span>
            <span class="legend-item transport">ğŸšŒ Transport</span>
            <span class="legend-item emergency">ğŸ¥ Emergency</span>
          </div>
        </div>

        <div class="poi-tabs">
          <button class="poi-tab active" data-type="all">All</button>
          <button class="poi-tab" data-type="water">ğŸ’§ Water</button>
          <button class="poi-tab" data-type="camping">â›º Camping</button>
          <button class="poi-tab" data-type="resupply">ğŸ›’ Resupply</button>
          <button class="poi-tab" data-type="transport">ğŸšŒ Transport</button>
          <button class="poi-tab" data-type="emergency">ğŸ¥ Emergency</button>
        </div>

        <div class="poi-list" id="poi-list"></div>

        <div class="download-buttons">
          <button class="download-btn" id="download-csv">Download CSV</button>
          <button class="download-btn" id="download-gpx">Download GPX Waypoints</button>
        </div>
      </div>
    </section>

    <footer>
      <p>POI data from <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>. Processing happens in your browser.</p>
      <p><a href="./">Back to Tools</a></p>
    </footer>
  </div>

  <script type="module" src="./enrich.ts"></script>
</body>
</html>
